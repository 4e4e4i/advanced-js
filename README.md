
# Advanced js

### Что такое 'use strict' и для чего он нужен

Что делает 'use strict'? Это частый вопрос, который мы можем встретить на собеседовании, неплохое начало для разговора.

Это простой вопрос, обычно ожидают, что кандидат на собеседовании знает ответ на него. Но даже если это простой вопрос
вы все еще можете произвести впечатление на интервьюера, показав глубокое понимание значения этого ключевого слова.

Так что же такое strict mode?

Strict mode позволяет вам разместить программу или функцию в так называемый строгий операционный контекст. 
И я собираюсь объяснить что это значит с несколькими примерами, но если в двухсловах, он позволяет легче дебажить код.
Ошибки кода, которые бы в противном случае были проигнорированы или втихую сфейлелись, теперь будут генерировать
ошибки или выбрасывать исключения. Это позволяет вам раньше обнаружить ошибки в коде и быстро направляет вас к источнику
проблемы.

Так первая вещь о которой вы должны сказать - это как включить его. Как включить strict mode в JS файле?

Один из путей, это просто напечатать строку 'use strict' и поместить ее в самом вверху файла. Если вас попросят на интервью
записать его, помните никогда не пишите как use strict. Это не специальное ключевое словое use и не специальное ключевое
слово strict. Это строка. И вы можете спросить, почему это строка? Это выглядит довольно странно. И ответ по-настоящему
очевидно прост. Когда эта функция была впервые разработана и реализована, старые браузеры не поддерживали ее, 
только новые браузеры поддерживали ее. 
Если бы решили использовать ключевое слово «use» и ключевое слово «strict» при загрузке этого файла в более 
старом браузере, браузер, который бы не знал об «use strict», выдал бы ошибку. И поэтому то что они сделали, они просто
положили его в строку и так старые браузеры читали этот файл, говорили "воу да это же строка в вверху файла, они ничего не делает
и поэтому я просто проигнорирую ее". А в новых браузерах, если он увидит строку 'use strict' они поймут, что необходимо
переключится в strict mode operating context.

Это один из путей, в котором можно сказать JS, чтобы он смотрел на код в strict mode. И используя данный подход,
strict mode будет применяться ко всему коду по всему файлу, но есть и другой способ.

```javascript
// Not strict mode... 
function newCode() {
  "use strict"
  // Strict mode...
}
// Not Strict mode...
```
Если вы возможно когда-либо работали с легаси JS кодом, очень-очень старым JS кодом. Я серьезно сомневаюсь, что вы
на самом деле окажетесь в данной ситуации, потому что 'use strict' существует уже очень давно. Но если у вас есть
полное знание, это действительно возможно применить 'strict mode' только к части кода, с помощью добавления 'use strict' 
в верхнюю часть блока функции, затем все что будет под данной строкой, будет читаться в strict mode, а все что снаружи блока
функции будет в non-strict mode. 

Я показал, как включать его. А какого назначение 'use strict' мода? Что он на самом деле делает?

Одна из первых вещей это, что в 'use strict' моде использование переменной перед тем как она была определена вызовет ошибку.

Например, без strict mode назначение значения недекларированной переменной возможно и будет автоматически создана глобальная
переменная с таким именем. В JS всегда есть глобальный объект и в нем находятся все глобальные переменные и 
глобальные функции. В браузере глобальный объект - 'window'. Но если вы используете его внутри node, глобальный объект
будет называться 'global'.

Поэтому с помощью декларирования asim = 1; мы создаем глобальную переменую, глобальное свойство на глобальной переменной
window, с названием asim и мы назначяем ей значение 1.

```javascript
asim = 1;
console.log(window.asim); // 1
```

Так мы разобрались как это работет...Так почему это плохая вещь? Почему это раздражает? Позвольте мне показать специфичный
пример, когда это может быть невероятно разочаровывающим. Давайте представим, что в моем приложением, я декларировал переменную
под названием theVal. Я декларировал ее должным образом, используя theVal в самом начале моего файла и назначил ей
значение 0. И затем, где-то в приложение я решил изменить значение моей theVal переменной в 1, но я сделал глупую ошибку -
вместо того, чтобы напечать theVal, я написал thVal. И наконец я использую переменную theVal в 'if' операторе, думая будто
я установил значение в 1 и, ожидая что выведет Hello. Но, к сожалению, Hello не будет выведено в консоле, потому что была совершена ошибка
в названии переменной.

```javascript
var theVal = 0;
//
thVal = 1;
//
if (theVal > 0) {
    console.log("Hello")
}
```
  
А теперь если мы используем 'use strict'. Вызов недекларированной переменной вызывает ошибку.

```javascript
"use strict";

var theVal = 0;
//
thVal = 1; // вызывает ошибку: thVal is not defined
//
if (theVal > 0) {
    console.log("Hello")
}
```

Другая фича "use strict" - то что она останавливает вас от использования слов, которые уже зарезервированны для
будущих версий JS. Давайте например создадим переменную let и назначим ей значение - 1. Затем перезагрузим страницу и все
будет впорядке. 

```javascript
var let = 1;
```

Но если я добавлю "use strict" на вверх файла, вы увидете ошибку вызванную данной переменной

```javascript
"use strict"

var let = 1; // Вызовет ошибку: Unexpected strict mode reserved word
```
Причина данной ошибки, что слово let уже зарезервированно для будущих версий JS. По факту уже используется
в ECMA script 6 версии JS

Еще одна фича 'use strict' - вы не можете удалять функции, переменные или аргументы функций.

Давайте посмотрим на примере без использования use strict. Если вы всего-лишь напечатаете var foo = 0 и затем
попытаетесь удалить foo, перезагрузите страницу, не возникнет никакой ошибки...Тоже самое с функциями

```javascript
var foo = 1;
delete foo;

function moo() {}
delete moo;
```

А если вы будете использовать 'use strict' mode, то при удалении будет вызвана ошибка

```javascript
"use strict"

var foo = 1;
delete foo; // Delete of an unqualified identifier in strict mode

function moo() {}
delete moo; // Delete of an unqualified identifier in strict mode
```

И следующая вещь, о которой я хотел бы рассказать - это ключевое слово eval и use strict mode.
Strict mode делает eval немного безопаснее.

Например в non-use strict mode вы можете делать вещи, такие как var eval = 1; или именовать так функции, и никакой ошибки
не будет вызвано.

А в use strict mode будет вызвана ошибка

```javascript
"use strict"

var eval = 1; // Unexpected eval or arguments in strict mode
```
Если вы знаете eval, он позволяет вам оценивать выражения JavaScript, просто передавая строку. Таким образом,
он позволяет вам выполнять только произвольные биты типа кода JavaScript в 'var a = 1'.

```javascript
eval('var a = 1');
console.log(a); // 1
```
Этот код выполняет 'var a = 1', но в non-use strict mode переменная A вытекает из выражений eval, поэтому, если
вызвать console.log (a); вы можете видеть, что он выводит значение переменной A, которая фактически создается или 
определяется в блоке eval. Таким образом, вы можете представить себе ситуации, в которых это может вызвать проблемы с 
безопасностью или просто загрязнить ваше собственное пространство имен.

Но если мы используем use strict mode, любые переменные, что вы определите внутри eval существуют только внутри eval и
не вытекают наружу.

```javascript
'use strict'

var a = 2;
eval('var a = 1');
console.log(a); // 2
```

